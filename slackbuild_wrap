#!/bin/sh -eux

SLACKBUILD="${1}"

# If compiling a native program
if [ "${HST}" = "${BUILD}" ]; then
  STRIP="strip"
  if echo "${HST}" | grep -q slackware-linux; then
    EXE_FORMAT="ELF"
  fi
else # cross-compiling
  if [ "${HST}" = "i686-w64-mingw32" ]; then
    export PKG_CONFIG_LIBDIR=${YYPREFIX}/lib/pkgconfig
    EXE_FORMAT="PE"
    STRIP=${HST}-strip
  elif [ "${HST}" = "x86_64-w64-mingw32" ]; then
    export PKG_CONFIG_LIBDIR=${YYPREFIX}/lib64/pkgconfig
    EXE_FORMAT="PE"
    STRIP=${HST}-strip
  fi
fi

export EXE_FORMAT STRIP
export HST TGT
export PREFIX="$(echo "${YYPREFIX}" | sed -e 's;^/;;')"

${SLACKBUILD}

